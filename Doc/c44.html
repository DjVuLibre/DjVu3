<HTML>
<HEAD>
   <TITLE> </TITLE>
   <META NAME="GENERATOR" CONTENT="DOC++ 3.4.1">
</HEAD>
<BODY BGCOLOR=#fefefe BACKGROUND=back.jpg>

<H2> <A HREF="#DOC.DOCU">c44</A></H2>
<BLOCKQUOTE>DjVu IW44 wavelet encoder. </BLOCKQUOTE>
<A NAME="DOC.DOCU">
<BLOCKQUOTE>
<B>Synopsis</B><BR>
<PRE>
        c44 [options] pnmfile [djvufile]
    </PRE><P><B>Description</B> ---
File <TT>&quot;c44.cpp&quot;</TT> illustrates the use of classes <!1><A HREF="IWBitmap.html">IWBitmap</A> and
IWPixmap for compressing and encoding a color image or a gray level
image using the DjVu IW44 wavelets.  This is the preferred mode for
creating a DjVu image which does not require separate layers for encoding
the text and the background images.  The files created by <TT>c44</TT> are
recognized by both the IW44 decoder (see program <!1><A HREF="d44.html">d44</A>) and by the
DjVu decoder (see program <!1><A HREF="ddjvu.html">ddjvu</A>).<P><B>Arguments</B> ---
Argument <TT>pnmfile</TT> is the name of the input file.  PGM files are
recognized for gray level images; PPM files are recognized for color
images.  Popular file formats can be converted to PGM or PPM using the
NetPBM package (<A HREF=http://www.arc.umn.edu/GVL/Software/netpbm.html>http://www.arc.umn.edu/GVL/Software/netpbm.html</A>)
or the ImageMagick package (<A HREF=http://www.wizards.dupont.com/cristy/>http://www.wizards.dupont.com/cristy/</A>).<P>Optional argument <TT>djvufile</TT> is the name of the output file.  It is
customary to use either suffix <TT>&quot;.djvu&quot;</TT>, <TT>&quot;.djv&quot;</TT>, <TT>&quot;.iw44&quot;</TT> or <TT>&quot;.iw4&quot;</TT>.
Suffix <TT>&quot;.djvu&quot;</TT> emphasizes the fact that IW44 files is seamlessly
recognized by the current DjVu decoder.  Suffix <TT>&quot;.iw4&quot;</TT> however was
required by older versions of the DjVu plugin.  If this argument is
omitted, a filename is generated by replacing the suffix of <TT>pnmfile</TT> with
suffix <TT>&quot;.iw4&quot;</TT>.<P><B>Quality Specification</B>---
Files produced by the DjVu IW44 Wavelet Encoder are IFF files composed of
an arbitrary number of chunks (see showiff and <!1><A HREF="IWImage.h.html">IWImage.h</A>)
containing successive refinements of the encoded image.  Each chunk is
composed of several slices.  A typical file contains a total of 100 slices
split between three or four chunks.  Various options provide quality
targets (<TT>-decibel</TT>), slicing targets (<TT>-slice</TT>) or file size targets
(<TT>-bpp</TT> or <TT>-size</TT>) for each of these refinements.  Chunks are generated
until meeting either the decibel target, the file size target, or the
slicing target for each chunk.
<DL>
<DT><B>-bpp n,..,n</B><DD> 
Selects a increasing sequence of bitrates for building 
progressive IW44 file (in bits per pixel).
<DT><B>-size n,..,n</B><DD> 
Selects a increasing sequence of minimal sizes for building 
progressive IW44 file (in bytes).
<DT><B>-decibel n,..,n</B><DD>
Selects an increasing sequence of luminance error expressed as decibels
ranging from 16 (very low quality) to 48 (very high quality).  This
criterion should not be used when recoding an image which was already
compressed with a lossy compression scheme (such as Wavelets or JPEG)
because successive losses of quality accumulate.    <DT><B>-slice n+...+n</B><DD>
Selects an increasing sequence of data slices expressed as integers 
ranging from 1 to 140. 
</DL>
These options take a target specification list expressed either as a comma
separated list of increasing numbers or as a list of numbers separated by
character <TT>'+'</TT>.  Both commands below for instance are equivalent:
<PRE>
    c44 -bpp 0.1,0.2,0.5 inputfile.ppm  outputfile.djvu
    c44 -bpp 0.1+0.1+0.3 inputfile.ppm  outputfile.djvu
    </PRE>
Both these commands generate a file whose first chunk encodes the image
with 0.1 bits per pixel, whose second chunk refines the image to 0.2 bits
per pixel and whose third chunk refines the image to 0.5 bits per pixel.
In other words, the second chunk provides an extra 0.1 bits per pixel and
the third chunk provides an extra 0.3 bits per pixels.<P>When no quality specification is provided, program <TT>c44</TT> usually generates
a file composed of three progressive refinement chunks whose quality
should be acceptable.  The best results however are achieved by precisely
tuning the image quality.  As a rule of thumb, <TT>c44</TT> generates an
acceptable quality when you specify a size equal to 50% to 75% of the size
of a comparable JPEG image.<P><B>Color Processing Specification</B> ---
Five options control the encoding of the chrominance information of color
images.  These options are of course meaningless for processing a gray
level image.
<DL>
<DT><B>-crcbnormal</B><DD>
Selects normal chrominance encoding (default).  Chrominance information is
encoded at the same resolution as the luminance. 
<DT><B>-crcbhalf</B><DD>
Selects half resolution chrominance encoding.  Chrominance information is
encoded at half the luminance resolution. 
<DT><B>-crcbdelay n</B><DD>
This option can be used with <TT>-crcbnormal</TT> and <TT>-crcbhalf</TT> for specifying
an encoding delay which reduces the bitrate associated with the chrominance. The
default chrominance encoding delay is 10 slices.
<DT><B>-crcbfull</B><DD>
Selects the highest possible quality for encoding the chrominance information. This
is equivalent to specifying <TT>-crcbnormal</TT> and <TT>-crcbdelay 0</TT>.
<DT><B>-crcbnone</B><DD>
Disables encoding of the chrominance.  Only the luminance information will
be encoded. The resulting image will show in shades of gray.
</DL><P><B>Advanced Options</B> ---
Program <TT>c44</TT> also recognizes the following options:
<DL>
<DT><B>-dbfrac f</B><DD>
This option alters the meaning of the -decibel option.  The decibel target then
addresses only the average error of the specified fraction of the most
misrepresented 32x32 pixel blocks.
<DT><B>-mask pbmfile</B><DD> 
This option can be used when we know that certain pixels of a background
image are going to be covered by foreground objects like text or drawings.
File <TT>pbmfile</TT> must be a PBM file whose size matches the size of the input
file.  Each black pixel in <TT>pbmfile</TT> means that the value of the corresponding
pixel in the input file is irrelevant.  The DjVu IW44 Encoder will replace
the masked pixels by a color value whose coding cost is minimal (see
<A HREF=http://www.research.att.com/~leonb/DJVU/mask>http://www.research.att.com/~leonb/DJVU/mask</A>).
</DL><P><B>Generating Photo DjVu instead of IW44</B> ---
Photo DjVu images have thje additional capability to store the resolution
and gamma correction information.  Using any of the following options will
generate a Photo DjVu Image instead of a IW44 file.  Program <!1><A HREF="d44.html">d44</A>
does not work on these files.  Program <!1><A HREF="ddjvu.html">ddjvu</A> handles both IW44 and
DjVu files.
<DL>
<DT><B>-dpi n</B><DD>  Sets the resolution information for a Photo DjVu image.
<DT><B>-gamma n</B><DD> Sets the gamma correction information for a Photo DjVu image.
</DL><P><B>Performance</B> ---
The main design objective for the DjVu wavelets consisted of allowing
progressive rendering and smooth scrolling of large images with limited
memory requirements.  Decoding functions process the compressed data and
update a memory efficient representation of the wavelet coefficients.
Imaging function then can quickly render an arbitrary segment of the image
using the available data.  Both process can be carried out in two threads
of execution.  This design plays an important role in the DjVu system.<P>We have investigated various state-of-the-art wavelet compression schemes:
although these schemes may achieve slightly smaller file sizes, the
decoding functions did not even approach our requirements.  The IW44
wavelets reach these requirements today and may in the future implement
more modern refinements (such as trellis quantization, bitrate
allocation, etc.) if (and only if) these refinements can be implemented
within our constraints.<P></BLOCKQUOTE>
<DL><DT><DT><B>Author:</B><DD>L&eacute;on Bottou &lt;leonb@research.att.com&gt;

<DT><B>Version:</B><DD><TT>$Id: c44.html,v 1.6 2001-08-08 18:01:31 docbill Exp $</TT> 
<DD></DL><P><I><A HREF="index.html">Alphabetic index</A></I> <I><A HREF="HIER.html">Hierarchy of classes</A></I></P><HR>
<!-- This is were the DOC++ footer is defined  -->

<font face="arial,helvetica" size="2">
<a href=http://www.djvu.att.com>DjVu</a> is a trademark of AT&amp;T.  
<br>All other products mentioned are registered trademarks or trademarks of
their respective companies.
</font>
