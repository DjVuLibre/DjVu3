# C- Copyright (c) 1999 AT&T Corp.  All rights reserved.
# C-
# C- This software may only be used by you under license from AT&T
# C- Corp. ("AT&T"). A copy of AT&T's Source Code Agreement is available at
# C- AT&T's Internet website having the URL <http://www.djvu.att.com/open>.
# C- If you received this software without first entering into a license with
# C- AT&T, you have an infringing copy of this software and cannot use it
# C- without violating AT&T's intellectual property rights.
# C-
# C- $Id: Makefile.in,v 1.18 2000-02-03 22:22:25 leonb Exp $

%%%include <paths>

SHELL=/bin/sh
prefix=@%prefix%@
bindir=@%PROJECT_PREFIX%@/bin
CXX=@%CXX%@
CXXOPT=@%CXXOPT%@ @%CXXUNROLL%@
CXXWARN=@%CXXWARN%@
DEFS=@%DEFS%@
INCS=@%INCS%@ -I.. -I./SRCDIR/..
CXXFLAGS=@%CXXFLAGS%@ $(CXXOPT) $(CXXWARN) $(DEFS) $(INCS)
LDFLAGS=
DOCXX=@%docxx%@
LIBS=@%libmath%@ @%LIBS%@
MAKESTLIB=@%make_stlib%@
MAKESHLIB=@%make_shlib%@
SRCDIR=./SRCDIR

%%%include <commands>

# Defs

LIB= $(LIBDJVUXX)
TARG= TestString TestException TestArray TestList TestMap\
      TestBitmap TestSmartPointer TestJB2 TestThreads


# Make all

all: $(TARG)
	echo Done.

# Generic rules

clean:
	-$(RM) 2>>/dev/null -rf $(TARG) *.o *.out ii_files *.rpo ; true

distclean:
	-$(RM) 2>>/dev/null -rf $(TARG) *.o *.out ii_files *.rpo Makefile Makefile.depend ; true


%%%include <depend>

PHONY: clean distclean


# Handle cpp files as C++

%%%include <compile>

.o: $(LIB)
	if [ -n "$(RPO)" ] ; then $(RPO) $*.o $(LIB) ; fi
	$(CXX) $(CXXFLAGS) $(LDFLAGS) -o $@ $*.o $(LIB) $(LIBS)
	@if test -f $(SRCDIR)/$@.exp ; then\
	   if $@ > $@.out 2>&1  &&  cmp -s $@.out $(SRCDIR)/$@.exp  ;\
	     then echo -- $@ passed ;\
	     else echo -- $@ begin ; cat $@.out ; echo -- $@ end ;\
           fi ;\
	   else echo -- $@ compiled ;\
	 fi

TestThreads: TestThreads.o $(LIB)
	if [ -n "$(RPO)" ] ; then $(RPO) TestThreads.o $(LIB) ; fi
	$(CXX) $(CXXFLAGS) $(LDFLAGS) -o TestThreads TestThreads.o $(LIB) $(LIBS)
	@if test -f $(SRCDIR)/$@.exp ; then\
	   if $@ 2>&1 | sort > $@.out 2>&1  &&  cmp -s $@.out $(SRCDIR)/$@.exp  ;\
	     then echo -- $@ passed ;\
	     else echo -- $@ begin ; cat $@.out ; echo -- $@ end ;\
           fi ;\
	   else echo -- $@ compiled ;\
	 fi

%%%include "Makefile.depend+++"

